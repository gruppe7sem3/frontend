<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Admin Panel</title>
     <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="html/css/admin.css">
</head>
<body>
    <!-- Placeholder for the navbar -->
    <div id="navbar-placeholder"></div>

    <h1>Movie Admin Panel</h1>

    <!-- Form for adding a new movie -->
    <h2>Add a Movie by IMDb ID</h2>
    <form id="movieForm">
        <label for="imdbId">IMDB ID:</label>
        <input type="text" id="imdbId" name="imdbId"><br>
        <label for="trailerLink">Trailer Link:</label>
        <input type="text" id="trailerLink" name="trailerLink"><br>
        <button type="submit">Add Movie</button>
    </form>

    <div id="response"></div>

    <hr>

    <!-- Button for deleting a movie -->
    <h2>Delete Movie by IMDb ID</h2>
    <label for="deleteImdbId">IMDb ID:</label>
    <input type="text" id="deleteImdbId" required>
    <button id="deleteMovieButton">Delete Movie</button>

    <div id="deleteResponse"></div>

    <script>
       document.getElementById('movieForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const imdbId = document.getElementById('imdbId').value;
            const trailerLink = document.getElementById('trailerLink').value;
            
            fetch('http://localhost:2222/api/movies', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `imdbId=${imdbId}&trailerLink=${encodeURIComponent(trailerLink)}`,
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('response').textContent = `Movie added: ${data.title}`;
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('response').textContent = 'An error occurred while adding the movie.';
            });
        });

        // Delete Movie functionality
        document.getElementById("deleteMovieButton").addEventListener("click", function () {
            const deleteImdbId = document.getElementById("deleteImdbId").value;
            // Send a DELETE request to your Spring Boot API to delete the movie
            fetch(`http://localhost:2222/api/movies/${deleteImdbId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("deleteResponse").textContent = `Movie deleted: ${JSON.stringify(data)}`;
            })
            .catch(error => {
                document.getElementById("deleteResponse").textContent = `Error: ${error.message}`;
            });
        });
    </script>
</body>
</html>
